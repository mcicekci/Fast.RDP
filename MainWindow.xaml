<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="FastRDP.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:FastRDP.Models"
    xmlns:local="using:FastRDP"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- InfoBar - EkranÄ±n en Ã¼stÃ¼nde bildirim mesajlarÄ± -->
        <InfoBar x:Name="NotificationInfoBar"
                 Grid.Row="0"
                 IsOpen="False"
                 IsClosable="True"
                 Margin="12,12,12,4"
                 CornerRadius="8">
            <InfoBar.ActionButton>
                <Button Content="ðŸ“‹ Kopyala" 
                        Click="OnCopyMessageClick"
                        Style="{StaticResource AccentButtonStyle}"
                        Padding="8,4"/>
            </InfoBar.ActionButton>
        </InfoBar>

        <!-- Ãœst Bar -->
        <Grid Grid.Row="1" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
              Padding="16,12" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" 
              BorderThickness="0,0,0,1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Logo ve BaÅŸlÄ±k -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12">
                <FontIcon Glyph="&#xE968;" FontSize="24" Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                <TextBlock Text="FastRDP" FontSize="20" FontWeight="SemiBold" VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Arama Kutusu -->
            <AutoSuggestBox Grid.Column="1" 
                            x:Name="SearchBox"
                            PlaceholderText="Ä°sim, host, kullanÄ±cÄ±, domain, etiket ara..."
                            QueryIcon="Find"
                            Margin="24,0"
                            VerticalAlignment="Center"
                            TextChanged="OnSearchTextChanged">
                <AutoSuggestBox.Description>
                    <TextBlock Text="GeliÅŸmiÅŸ arama: TÃ¼m profil bilgilerinde arama yapÄ±lÄ±r" 
                               FontSize="10"
                               Foreground="{ThemeResource TextFillColorTertiaryBrush}"/>
                </AutoSuggestBox.Description>
            </AutoSuggestBox>

            <!-- Ayarlar -->
            <Button Grid.Column="2" 
                    Margin="0,0,8,0"
                    ToolTipService.ToolTip="Ayarlar"
                    Click="OnSettingsClick">
                <FontIcon Glyph="&#xE713;" FontSize="16"/>
            </Button>

            <!-- Tema DeÄŸiÅŸtir -->
            <Button Grid.Column="3" 
                    Margin="0,0,8,0"
                    ToolTipService.ToolTip="Tema DeÄŸiÅŸtir"
                    Click="OnThemeButtonClick">
                <FontIcon Glyph="&#xE771;" FontSize="16"/>
            </Button>

            <!-- Yenile -->
            <Button Grid.Column="4"
                    Style="{StaticResource AccentButtonStyle}"
                    Click="OnRefreshClick"
                    ToolTipService.ToolTip="Yenile">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE72C;" FontSize="16"/>
                    <TextBlock Text="Yenile"/>
                </StackPanel>
            </Button>
        </Grid>

        <!-- Ana Ä°Ã§erik -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Sol Panel - Filtreler -->
            <Grid Grid.Column="0" Background="{ThemeResource LayerFillColorDefaultBrush}" 
                  BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="0,0,1,0">
                <ScrollViewer>
                    <StackPanel Padding="16" Spacing="8">
                        <TextBlock Text="FÄ°LTRELER" FontSize="12" FontWeight="SemiBold" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,8"/>

                        <RadioButton Content="TÃ¼mÃ¼" GroupName="Filter" IsChecked="True" 
                                     Click="OnFilterChanged" Tag="all"/>
                        
                        <RadioButton GroupName="Filter" Click="OnFilterChanged" Tag="favorites">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE735;" FontSize="14"/>
                                <TextBlock Text="Favoriler"/>
                            </StackPanel>
                        </RadioButton>
                        
                        <RadioButton GroupName="Filter" Click="OnFilterChanged" Tag="recent">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE823;" FontSize="14"/>
                                <TextBlock Text="Son KullanÄ±lanlar"/>
                            </StackPanel>
                        </RadioButton>

                        <MenuFlyoutSeparator Margin="0,12"/>

                        <Button Click="OnCreateNewProfileClick"
                                Style="{StaticResource AccentButtonStyle}"
                                HorizontalAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE710;" FontSize="14"/>
                                <TextBlock Text="Yeni Profil"/>
                            </StackPanel>
                        </Button>

                        <Button Click="OnBackupClick"
                                HorizontalAlignment="Stretch"
                                Margin="0,4,0,0">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE777;" FontSize="14"/>
                                <TextBlock Text="Yedekle"/>
                            </StackPanel>
                        </Button>

                        <MenuFlyoutSeparator Margin="0,8"/>

                        <Button Click="OnImportRdpClick"
                                HorizontalAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8B5;" FontSize="14"/>
                                <TextBlock Text="RDP Ä°Ã§e Aktar"/>
                            </StackPanel>
                        </Button>

                        <TextBlock Text="veya RDP dosyalarÄ±nÄ± sÃ¼rÃ¼kle-bÄ±rak"
                                   FontSize="11"
                                   Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                   HorizontalAlignment="Center"
                                   Margin="0,8,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>

            <!-- Orta Panel - Profil Listesi (GruplandÄ±rÄ±lmÄ±ÅŸ + Drop Zone) -->
            <Grid Grid.Column="1" Padding="16"
                  AllowDrop="True"
                  DragOver="OnDragOver"
                  Drop="OnDrop">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Liste BaÅŸlÄ±ÄŸÄ± -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="12" Margin="0,0,0,12">
                    <TextBlock Text="PROFILLER" FontSize="12" FontWeight="SemiBold" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    <Border Background="{ThemeResource AccentFillColorDefaultBrush}"
                            Padding="6,2"
                            CornerRadius="4"
                            Opacity="0.2">
                        <TextBlock Text="RDP dosyalarÄ±nÄ± buraya sÃ¼rÃ¼kleyin" 
                                   FontSize="10" 
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    </Border>
                </StackPanel>

                <!-- GruplandÄ±rÄ±lmÄ±ÅŸ Profil Listesi -->
                <ListView Grid.Row="1" 
                          x:Name="ProfilesList"
                          SelectionMode="Single"
                          DoubleTapped="OnProfileDoubleTapped"
                          SelectionChanged="OnProfileSelectionChanged">
                    
                    <!-- Grup BaÅŸlÄ±ÄŸÄ± Stili -->
                    <ListView.GroupStyle>
                        <GroupStyle>
                            <GroupStyle.HeaderTemplate>
                                <DataTemplate>
                                    <Grid Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                          Padding="12,8"
                                          Margin="0,12,0,8"
                                          CornerRadius="8">
                                        <StackPanel Orientation="Horizontal" Spacing="12">
                                            <FontIcon Glyph="&#xE8F1;" 
                                                      FontSize="16"
                                                      Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                            <TextBlock Text="{Binding Key}" 
                                                       FontWeight="SemiBold" 
                                                       FontSize="16"
                                                       Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                            <Border Background="{ThemeResource AccentFillColorDefaultBrush}"
                                                    Padding="6,2"
                                                    CornerRadius="4"
                                                    Opacity="0.3">
                                                <TextBlock Text="{Binding ItemCount}" 
                                                           FontSize="11"
                                                           FontWeight="SemiBold"
                                                           Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                            </Border>
                                        </StackPanel>
                                    </Grid>
                                </DataTemplate>
                            </GroupStyle.HeaderTemplate>
                        </GroupStyle>
                    </ListView.GroupStyle>
                    
                    <!-- Profil Item Template -->
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="models:RdpProfile">
                            <Grid Padding="12" CornerRadius="8" Margin="4"
                                  Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                  BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                  BorderThickness="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Icon -->
                                <Border Grid.Column="0" 
                                        Width="48" Height="48" 
                                        Background="{ThemeResource AccentFillColorDefaultBrush}" 
                                        CornerRadius="8"
                                        Margin="0,0,12,0">
                                    <FontIcon Glyph="&#xE968;" 
                                              FontSize="24" 
                                              Foreground="White"/>
                                </Border>

                                <!-- Info -->
                                <StackPanel Grid.Column="1" 
                                            VerticalAlignment="Center" 
                                            Spacing="4">
                                    <TextBlock Text="{x:Bind Name}" 
                                               FontWeight="SemiBold" 
                                               FontSize="15"
                                               TextTrimming="CharacterEllipsis"/>
                                    <TextBlock Text="{x:Bind Host}" 
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                                               FontSize="13"
                                               TextTrimming="CharacterEllipsis"/>
                                    <TextBlock Text="{x:Bind Username}" 
                                               Foreground="{ThemeResource TextFillColorTertiaryBrush}" 
                                               FontSize="12"
                                               TextTrimming="CharacterEllipsis"
                                               Visibility="{x:Bind local:MainWindow.StringToVisibility(Username)}"/>
                                </StackPanel>

                                <!-- Favorite Icon -->
                                <Grid Grid.Column="2" 
                                      VerticalAlignment="Top"
                                      Margin="8,0,0,0">
                                    <FontIcon Glyph="&#xE735;" 
                                              FontSize="16" 
                                              Foreground="#FFB900"
                                              Visibility="{x:Bind local:MainWindow.BoolToVisibility(Favorite)}"/>
                                </Grid>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <!-- Drag & Drop GÃ¶rsel Geri Bildirim -->
                <Border x:Name="DragDropOverlay"
                        Grid.Row="0" Grid.RowSpan="2"
                        Background="{ThemeResource AccentFillColorDefaultBrush}"
                        Opacity="0"
                        IsHitTestVisible="False"
                        CornerRadius="8"
                        BorderBrush="{ThemeResource AccentFillColorDefaultBrush}"
                        BorderThickness="3">
                    <StackPanel HorizontalAlignment="Center" 
                                VerticalAlignment="Center"
                                Spacing="16">
                        <FontIcon Glyph="&#xE896;" 
                                  FontSize="64" 
                                  Foreground="White"/>
                        <TextBlock Text="RDP dosyalarÄ±nÄ± bÄ±rakÄ±n" 
                                   FontSize="20" 
                                   FontWeight="Bold"
                                   Foreground="White"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Dosyalar otomatik olarak iÃ§e aktarÄ±lacak" 
                                   FontSize="14" 
                                   Foreground="White"
                                   Opacity="0.8"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- SaÄŸ Panel - Detay -->
            <Grid Grid.Column="2" x:Name="DetailPanel" Background="{ThemeResource LayerFillColorDefaultBrush}" 
                  BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1,0,0,0"
                  Padding="16">
                <ScrollViewer>
                    <StackPanel x:Name="ProfileDetails" Spacing="16" Visibility="Collapsed">
                        <TextBlock Text="PROFÄ°L DETAYI" FontSize="12" FontWeight="SemiBold" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

                        <!-- Profil Bilgileri -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="BaÄŸlantÄ± AdÄ±:" FontSize="12" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock x:Name="ProfileName" FontSize="16" FontWeight="SemiBold"/>
                        </StackPanel>

                        <StackPanel Spacing="8">
                            <TextBlock Text="Host:" FontSize="12" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock x:Name="ProfileHost" FontSize="14"/>
                        </StackPanel>

                        <StackPanel Spacing="8">
                            <TextBlock Text="KullanÄ±cÄ± AdÄ±:" FontSize="12" 
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <TextBlock x:Name="ProfileUsername" FontSize="14"/>
                        </StackPanel>

                        <MenuFlyoutSeparator/>

                        <!-- Aksiyonlar -->
                        <Button Content="BaÄŸlan" 
                                Click="OnConnectClick"
                                Style="{StaticResource AccentButtonStyle}"
                                HorizontalAlignment="Stretch">
                            <Button.ContentTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8A7;" FontSize="16"/>
                                        <TextBlock Text="BaÄŸlan" FontWeight="SemiBold"/>
                                    </StackPanel>
                                </DataTemplate>
                            </Button.ContentTemplate>
                        </Button>

                        <Button Content="DÃ¼zenle" 
                                Click="OnEditClick"
                                HorizontalAlignment="Stretch">
                            <Button.ContentTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE70F;" FontSize="16"/>
                                        <TextBlock Text="DÃ¼zenle"/>
                                    </StackPanel>
                                </DataTemplate>
                            </Button.ContentTemplate>
                        </Button>

                        <Button Content="Sil" 
                                Click="OnDeleteClick"
                                HorizontalAlignment="Stretch"
                                Foreground="Red">
                            <Button.ContentTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE74D;" FontSize="16"/>
                                        <TextBlock Text="Sil"/>
                                    </StackPanel>
                                </DataTemplate>
                            </Button.ContentTemplate>
                        </Button>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>

        <!-- Alt Bar -->
        <Grid Grid.Row="3" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
              Padding="16,8" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" 
              BorderThickness="0,1,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" x:Name="StatusText" VerticalAlignment="Center" FontSize="13">
                Toplam Profil: 0
            </TextBlock>

            <TextBlock Grid.Column="1" VerticalAlignment="Center" FontSize="12" 
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}">
                FastRDP v1.0
            </TextBlock>
        </Grid>
    </Grid>
</Window>
